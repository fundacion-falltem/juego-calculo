/* ======================================================
   FALLTEM ‚Äî C√°lculo amable (web + mobile)
   Versi√≥n mejorada (secciones ordenadas)
   ====================================================== */


/* ======================================================
   1) VARIABLES / TEMA
   ====================================================== */
:root{
  color-scheme: light dark;
  --fs-base: clamp(18px, 1.05vw + 14px, 22px);
  --space: clamp(12px, 1vw + 8px, 18px);
  --font: "Montserrat", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;

  /* Neutros (modo oscuro por defecto) */
  --bg:#0b0b0b; --fg:#f5f5f5; --muted:#cfcfcf;
  --card:#171717; --border:#2a2a2a; --focus:#0ea5e9;

  /* Marca */
  --btn-primary-bg:#99cd68; --btn-primary-fg:#08340f; /* verde */
  --btn-sec-bg:#5fcbe0;     --btn-sec-fg:#072a32;     /* celeste */

  --ok:#16a34a; --bad:#dc2626;
}
[data-theme="light"]{
  --bg:#f8fbf4; --fg:#1b1b1b; --muted:#374151; /* m√°s legible en light */
  --card:#ffffff; --border:#e5e7eb; --focus:#5fcbe0;

  /* FABs con fondo oscuro y texto CLARO */
  --btn-sec-bg:#1b2325;
  --btn-sec-fg:#eaf6ff;   /* o #ffffff */
}
.fixed-top-right .btn-ayuda{
  text-shadow: 0 1px 1px rgba(0,0,0,.35);
}


/* ======================================================
   2) BASE / LAYOUT
   ====================================================== */
*{ box-sizing:border-box }
html,body{ height:100% }
html{ -webkit-text-size-adjust:100%; text-size-adjust:100% }
body{
  margin:0; background:var(--bg); color:var(--fg);
  font-family:var(--font); font-size:var(--fs-base); line-height:1.65;
  -webkit-tap-highlight-color: transparent;
}
.wrap{ max-width:980px; width:min(980px, calc(100% - 2*var(--space))); margin:0 auto; padding:var(--space) }

.header{ margin-inline:auto; max-width: 860px; }
.header h1{ font-size: clamp(2rem, 1.4vw + 1.6rem, 2.6rem); margin:.4rem 0 0; font-weight:900; letter-spacing:.2px }
.intro{ margin:.5rem 0 var(--space) }


/* ======================================================
   3) TARJETA / CONTENEDORES
   ====================================================== */
.card{
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 14px;
  padding: clamp(12px, 2.2vw, 20px);
  margin: 10px auto;
  max-width: 860px;
  box-shadow: 0 2px 10px rgba(0,0,0,.06);
}


/* ======================================================
   4) CONTROLES (selects + botones de cabecera)
   ====================================================== */
.controles{
  display:grid;
  grid-template-columns: 1fr;
  gap: .9rem 1rem; align-items:end;
  margin-bottom: calc(var(--space) * 1.1);
}
.control label{ display:block; font-weight:900; margin-bottom:.35rem }

select{
  appearance:none; -webkit-appearance:none; -moz-appearance:none;
  background:var(--card); color:var(--fg);
  border:1px solid var(--border); border-radius:.9rem;
  padding:.85rem 1rem; width:100%; font-size:1.05rem;
  background-image:url("data:image/svg+xml;utf8,<svg fill='currentColor' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'><path d='M5.5 7l4.5 5 4.5-5z'/></svg>");
  background-repeat:no-repeat; background-position:right 1rem center; background-size:1rem; padding-right:2.4rem;
}

/* Botonera de controles */
.control.buttons{
  display:flex; gap:.9rem; flex-wrap:wrap;
  justify-content:center; align-items:center;
}


/* ======================================================
   5) BOTONES (base)
   ====================================================== */
.btn{
  border:0; border-radius:14px; cursor:pointer; font-weight:900;
  padding:.95rem 1.2rem; min-height:50px; font-size:1.06rem;
  transition: transform .08s ease, filter .15s ease, box-shadow .15s ease, background-color .15s ease;
}
.btn:hover{ filter:brightness(1.05); transform: translateY(-1px) }
.btn:focus-visible{ outline:3px solid var(--focus); outline-offset:3px }
.btn.principal{ background:var(--btn-primary-bg); color:var(--btn-primary-fg) }
.btn.secundario{ background:var(--btn-sec-bg); color:var(--btn-sec-fg) }


/* ======================================================
   6) RESPONSIVE DE CONTROLES
   ====================================================== */
@media (min-width: 900px){
  .controles{
    grid-template-columns: repeat(3, minmax(220px, 1fr));
  }
  .control.buttons{
    grid-column: 1 / -1;
    justify-content:center;
    margin-top: .2rem;
  }
  .control.buttons .btn{ min-width: 220px; }
}


/* ======================================================
   7) JUEGO ‚Äî SECCI√ìN CENTRAL
   ====================================================== */

/* Tarjeta de la pr√°ctica: m√°s protagonista y estrecha */
.juego .card{
  padding: clamp(16px, 2.6vw, 28px);
  max-width: 720px;
  margin-inline: auto;
}

/* Meta (tiempo / ronda) cerca del enunciado */
.juego .meta{
  display:flex;
  justify-content:space-between;
  align-items:center;
  font-weight:800;
  margin:.2rem 0 .4rem;
  opacity:.9;
}

/* Barra de progreso general */
.juego .progresoBar{
  height:10px; background: color-mix(in oklab, var(--border) 80%, transparent);
  border-radius:999px; overflow:hidden; margin-bottom:.9rem;
}
#pbFill{ height:100%; width:0%; background:var(--btn-primary-bg); transition: width .25s ease }

/* Enunciado m√°s jer√°rquico y centrado */
.enunciado{
  font-size: clamp(2rem, 2.2vw + 1.2rem, 3rem);
  font-weight:900;
  text-align:center;
  letter-spacing:0;
  margin:.4rem 0 1.1rem;
}

/* Opciones m√∫ltiples (A‚ÄìD) */
.opciones{
  display:grid; grid-template-columns: 1fr; gap:1rem; margin-top:.6rem;
}
@media (min-width: 700px){
  .opciones{ grid-template-columns: 1fr 1fr; }
}
.opcion-btn{
  text-align:left;
  display:flex; align-items:center; gap:.6rem;
  background:var(--card); color:var(--fg);
  border:2px solid var(--border); border-radius: 14px;
  padding:1rem 1.1rem; font-weight:800; font-size: clamp(1.05rem, 0.6vw + 1rem, 1.25rem);
  cursor:pointer; box-shadow:0 2px 6px rgba(0,0,0,.08);
  transition: transform .12s ease, filter .15s ease, border-color .15s ease, box-shadow .15s ease, background-color .15s ease;
}
.opcion-btn strong{ margin-right:.4rem }
.opcion-btn:hover{ filter:brightness(1.06); transform:translateY(-1px); }
.opcion-btn:active{ transform: translateY(0); }

/* foco accesible y consistente */
.opcion-btn:focus-visible{
  outline:none;
  border-color:var(--focus);
  box-shadow:0 0 0 3px color-mix(in oklab, var(--focus) 45%, transparent);
}

/* Estado seleccionado previo al veredicto */
.opcion-btn.is-selected{
  border-color: var(--focus);
  box-shadow: 0 0 0 3px color-mix(in oklab, var(--focus) 35%, transparent);
  background: color-mix(in oklab, var(--focus) 10%, var(--card));
}

/* Feedback final (ok/bad) */
.opcion-btn.ok{
  border-color:var(--ok);
  box-shadow:0 0 0 3px color-mix(in oklab, var(--ok) 35%, transparent);
  background: color-mix(in oklab, var(--ok) 12%, var(--card));
}
.opcion-btn.bad{
  border-color:var(--bad);
  box-shadow:0 0 0 3px color-mix(in oklab, var(--bad) 35%, transparent);
  background: color-mix(in oklab, var(--bad) 8%, var(--card));
}


/* ======================================================
   8) TIMER
   ====================================================== */
.timer-text{ margin:.35rem 0 .25rem; font-weight:800; opacity:.95 }
.timerBar{
  height:8px; background: color-mix(in oklab, var(--border) 80%, transparent);
  border-radius:999px; overflow:hidden; margin-bottom:.6rem;
}
/* degrad√© de urgencia seg√∫n data-level: normal|warn|alert */
#timerFill{
  height:100%; width:0%;
  background: var(--btn-sec-bg);
  transition: width .10s linear, background-color .15s ease;
}
#timerFill[data-level="warn"]  { background:#f59e0b; }
#timerFill[data-level="alert"] { background:var(--bad); }
.timer-alert{ color: var(--bad); font-weight:900 }
@media (prefers-reduced-motion: no-preference){
  .timer-pulse{ animation: pulse .8s ease-in-out infinite }
  @keyframes pulse{ 0%{transform:scale(1)} 50%{transform:scale(1.06)} 100%{transform:scale(1)} }
}


/* ======================================================
   9) MENSAJES / FEEDBACK FINAL
   ====================================================== */
.feedback{
  margin-top: .8rem;
  font-weight: 800;
}
.feedback.ok{ color: var(--ok); }
.feedback.bad{ color: var(--bad); }
.feedback.muted{ color: var(--muted); }


/* ======================================================
   10) CTAs (acciones al final de sesi√≥n)
   ====================================================== */
.cta-buttons{
  display: flex;
  flex-wrap: wrap;
  gap: .6rem;
  margin-top: 1rem;
  justify-content: center;
}


/* ======================================================
   11) FABs (AYUDA + TEMA)
   ====================================================== */
.fixed-top-right{
  position: fixed;
  top: calc(12px + env(safe-area-inset-top, 0px));
  right: calc(12px + env(safe-area-inset-right, 0px));
  z-index: 10;
  display:flex; flex-direction:column; gap:12px;
}

/* Ayuda (?) */
.btn-ayuda{
  width:56px; height:56px; border-radius:50%;
  border:0; cursor:pointer;
  background:var(--btn-sec-bg); color:var(--btn-sec-fg);
  font-weight:900; font-size:1.4rem; line-height:1;
  box-shadow:0 4px 14px rgba(0,0,0,.25);
}
.btn-ayuda:focus-visible{ outline:3px solid var(--focus); outline-offset:2px }

/* Tema (√≠cono con ::before; sin texto) */
.btn-theme{
  width:56px; height:56px; border-radius:50%;
  border:0; cursor:pointer; line-height:1;
  display:inline-flex; align-items:center; justify-content:center;
  background:var(--btn-sec-bg); color:var(--btn-sec-fg);
  box-shadow:0 4px 14px rgba(0,0,0,.25);
  font-size:0; /* ocultar texto si lo hubiese */
}
.btn-theme:focus-visible{ outline:3px solid var(--focus); outline-offset:2px }
/* Icono seg√∫n tema */
[data-theme="light"] .btn-theme::before{
  content:"üåô"; font-size:1.45rem; filter: drop-shadow(0 0 1px rgba(0,0,0,.35));
}
[data-theme="dark"] .btn-theme::before{
  content:"‚òÄÔ∏è"; font-size:1.45rem; filter: drop-shadow(0 0 1px rgba(0,0,0,.35));
}


/* ======================================================
   12) MODAL
   ====================================================== */
.modal[hidden]{ display:none !important; }
.modal{
  position:fixed; inset:0;
  display:flex; align-items:flex-start; justify-content:center;
  padding:min(5vh,48px) 16px;
  background:rgba(0,0,0,.55);
  z-index:1000;
}
.modal-card{
  width:min(820px,100%);
  background:var(--card); color:var(--fg);
  border:1px solid var(--border); border-radius:12px;
  box-shadow:0 12px 30px rgba(0,0,0,.35);
  padding:var(--space);
}
.modal-actions{ display:flex; gap:10px; justify-content:flex-end }


/* ======================================================
   13) FOOTER
   ====================================================== */
.mini-credit{
  margin-top:.6rem; padding:.4rem 0;
  border-top:1px solid var(--border);
  font-size:.65em; line-height:1.35; color:var(--muted);
  max-width:980px; margin-inline:auto;
  display:flex; flex-direction:column; align-items:center; text-align:center;
}


/* ======================================================
   14) ACCESIBILIDAD / PREFERENCIAS
   ====================================================== */
.skip{ position:absolute; left:-9999px; top:auto }
.skip:focus{
  left:12px; top:12px; background:var(--btn-primary-bg); color:var(--btn-primary-fg);
  padding:8px 10px; border-radius:8px; z-index:1000;
}

/* Tama√±o muy grande */
html.muy-grande{ font-size:125% }
html.muy-grande body{ --fs-base: clamp(20px, 1.3vw + 16px, 24px) }

/* Reduce motion */
@media (prefers-reduced-motion: reduce){
  *{ scroll-behavior:auto }
  #pbFill{ transition:none }
}

/* ======================================================
   CTAs de cierre (finalActions)
   ====================================================== */

#finalActions {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: .6rem;
  margin-top: 1.2rem;
}

#finalActions .btn {
  min-width: 220px;
  padding: 1rem 1.4rem;
  font-size: 1.1rem;
}

#finalActions a {
  font-size: .9rem;
  color: var(--muted);
  text-decoration: none;
  transition: color .15s ease;
}

#finalActions a:hover,
#finalActions a:focus {
  color: var(--focus);
  text-decoration: underline;
}
