/* ======================================================
   FALLTEM — Cálculo amable (web + mobile)
   Versión limpia 2025-11
   ====================================================== */

/* ===== Variables de tema ===== */
:root{
  color-scheme: light dark;
  --fs-base: clamp(18px, 1.05vw + 14px, 22px);
  --space: clamp(12px, 1vw + 8px, 18px);
  --font: "Montserrat", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;

  /* Neutros (modo oscuro por defecto) */
  --bg:#0b0b0b; --fg:#f5f5f5; --muted:#cfcfcf;
  --card:#171717; --border:#2a2a2a; --focus:#0ea5e9;

  /* Botones flotantes */
  --btn-sec-bg:#334155;
  --btn-sec-fg:#e5f4ff;

  --btn-primary-bg:#99cd68; --btn-primary-fg:#062d0f;
  --ok:#22c55e; --bad:#f97373;
}

/* Tema claro (cuando se usa data-theme="light" o el body tailwind claro) */
[data-theme="light"],
body.bg-slate-100{
  --bg:#f3f4f6; --fg:#0f172a; --muted:#6b7280;
  --card:#ffffff; --border:#e5e7eb; --focus:#5fcbe0;

  /* FABs con fondo oscuro y texto CLARO */
  --btn-sec-bg:#1b2325;
  --btn-sec-fg:#eaf6ff;
}

.fixed-top-right .btn-ayuda{
  text-shadow:0 1px 1px rgba(0,0,0,.35);
}

/* ======================================================
   Base
   ====================================================== */
*{ box-sizing:border-box }
html,body{ height:100% }
html{ -webkit-text-size-adjust:100%; text-size-adjust:100% }

body{
  margin:0;
  background:var(--bg);
  color:var(--fg);
  font-family:var(--font);
  font-size:var(--fs-base);
  line-height:1.65;
  -webkit-tap-highlight-color: transparent;
}

.wrap{
  max-width:980px;
  width:min(980px, calc(100% - 2*var(--space)));
  margin:0 auto;
  padding:var(--space);
}

/* ======================================================
   Utilitarios
   ====================================================== */
.visually-hidden{
  position:absolute !important;
  width:1px !important;
  height:1px !important;
  padding:0 !important;
  margin:-1px !important;
  overflow:hidden !important;
  clip:rect(0,0,0,0) !important;
  white-space:nowrap !important;
  border:0 !important;
}

/* ======================================================
   Tarjetas
   ====================================================== */
.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:16px;
  padding:clamp(14px, 2vw, 22px);
  margin:6px auto;
  max-width:860px;
  box-shadow:0 2px 10px rgba(15,23,42,.06);
}

/* Menos separación entre controles y juego */
section.card + section.card.juego{
  margin-top:8px;
}

/* ======================================================
   Controles
   ====================================================== */
.controles{
  display:grid;
  grid-template-columns:1fr;
  gap:.9rem 1rem;
  align-items:end;
  margin-bottom:calc(var(--space) * 1.1);
}

.control label{
  display:block;
  font-weight:900;
  margin-bottom:.35rem;
}

/* Selects */
select{
  appearance:none;
  -webkit-appearance:none;
  -moz-appearance:none;
  background:var(--card);
  color:var(--fg);
  border:1px solid var(--border);
  border-radius:.9rem;
  padding:.85rem 1rem;
  width:100%;
  font-size:1.05rem;
  background-image:url("data:image/svg+xml;utf8,<svg fill='currentColor' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'><path d='M5 7l5 5 5-5H5z'/></svg>");
  background-repeat:no-repeat;
  background-position:right .85rem center;
  background-size:1rem 1rem;
}
select:focus-visible{
  outline:2px solid var(--focus);
  outline-offset:2px;
}

/* Botonera de controles – definición base */
.control.buttons{
  display:block;
  grid-column:1 / -1;
}
.control.buttons .btn{
  width:100%;
  min-width:0;
  padding-block:0.95rem;
  border-radius:18px;
}

/* Layout responsive de controles */
@media (min-width:720px){
  .controles{
    grid-template-columns:repeat(4, minmax(0, 1fr));
  }
}

/* ======================================================
   Botones genéricos
   ====================================================== */
.btn{
  border:0;
  border-radius:14px;
  cursor:pointer;
  font-weight:900;
  padding:0.85rem 1.15rem;
  min-height:46px;
  font-size:1.02rem;
  transition:
    transform .08s ease,
    filter .15s ease,
    box-shadow .15s ease,
    background-color .15s ease;
}
.btn:hover{
  filter:brightness(1.05);
  transform:translateY(-1px);
}
.btn:active{
  transform:translateY(0);
}
.btn:focus-visible{
  outline:3px solid var(--focus);
  outline-offset:3px;
}

.btn.principal{
  background:var(--btn-primary-bg);
  color:var(--btn-primary-fg);
}
.btn.secundario{
  background:var(--btn-sec-bg);
  color:var(--btn-sec-fg);
}

/* Separación vertical entre botones de "Comenzar" y "Volver a jugar" */
.control.buttons{
  display: flex;
  flex-direction: column;
  gap: 1.5rem; /* separación más amplia entre "Comenzar" y "Volver a jugar" */
}

/* ======================================================
   Juego
   ====================================================== */
.juego .progresoBar{
  height:10px;
  background:color-mix(in oklab, var(--border) 80%, transparent);
  border-radius:999px;
  overflow:hidden;
  margin-bottom:.9rem;
}
#pbFill{
  height:100%;
  width:0%;
  background:var(--btn-primary-bg);
  transition:width .25s ease;
}

/* Timer */
.timer-text{
  margin:.35rem 0 .35rem;
  font-weight:900;
  letter-spacing:.01em;
  opacity:.98;
}
.timerBar{
  height:12px;
  background:color-mix(in oklab, var(--border) 75%, transparent);
  border-radius:999px;
  overflow:hidden;
  margin-bottom:1rem;
}
#timerFill{
  height:100%;
  width:0%;
  background:var(--btn-sec-bg);
  transition:width .10s linear
}
#timerFill[data-level="warn"]{
  background:#f59e0b;
}
#timerFill[data-level="alert"]{
  background:var(--bad);
}
.timer-alert{
  color:var(--bad);
  font-weight:900;
}
@media (prefers-reduced-motion:no-preference){
  .timer-pulse{
    animation:pulse .8s ease-in-out infinite;
  }
  @keyframes pulse{
    0%{ transform:scale(1); }
    50%{ transform:scale(1.06); }
    100%{ transform:scale(1); }
  }
}

/* Enunciado */
.enunciado{
  font-size:clamp(2rem, 2.2vw + 1.2rem, 3rem);
  font-weight:900;
  text-align:center;
  letter-spacing:0;
  margin:.4rem 0 1.1rem;
}

/* Opciones */
.opciones{
  display:grid;
  grid-template-columns:1fr;
  gap:.8rem;
}
@media (min-width:640px){
  .opciones{
    grid-template-columns:repeat(2, minmax(0,1fr));
  }
}

.opcion-btn{
  text-align:left;
  display:flex;
  align-items:center;
  gap:.6rem;
  background:var(--card);
  color:var(--fg);
  border:2px solid var(--border);
  border-radius:14px;
  padding:1rem 1.1rem;
  font-weight:800;
  font-size:clamp(1.05rem, 0.6vw + 1rem, 1.25rem);
  cursor:pointer;
  box-shadow:0 2px 6px rgba(0,0,0,.08);
  transition:
    transform .12s ease,
    filter .15s ease,
    border-color .15s ease,
    box-shadow .15s ease,
    background-color .15s ease;
}
.opcion-btn:hover{
  filter:brightness(1.03);
  transform:translateY(-1px);
}
.opcion-btn span.tag{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  width:2.2rem;
  height:2.2rem;
  border-radius:999px;
  background:rgba(15,23,42,.9);
  color:#fff;
  font-weight:900;
  font-size:.95rem;
}
.opcion-btn span.texto{
  flex:1;
}
.opcion-btn[aria-disabled="true"]{
  cursor:default;
  opacity:.85;
}
.opcion-btn:focus-visible{
  outline:none;
  border-color:var(--focus);
  box-shadow:0 0 0 3px color-mix(in oklab, var(--focus) 45%, transparent);
}
.opcion-btn.is-selected{
  border-color:var(--focus);
  box-shadow:0 0 0 3px color-mix(in oklab, var(--focus) 35%, transparent);
  background:color-mix(in oklab, var(--focus) 10%, var(--card));
}
.opcion-btn.ok{
  border-color:var(--ok);
  box-shadow:0 0 0 3px color-mix(in oklab, var(--ok) 35%, transparent);
  background:color-mix(in oklab, var(--ok) 12%, var(--card));
}
.opcion-btn.bad{
  border-color:var(--bad);
  box-shadow:0 0 0 3px color-mix(in oklab, var(--bad) 35%, transparent);
  background:color-mix(in oklab, var(--bad) 8%, var(--card));
}

/* Feedback + estado */
.feedback{
  margin-top:.8rem;
  text-align:center;
  min-height:1.4em;
}

.feedback.is-final{
  font-size:1.02rem;
  font-weight:700;
  padding:.6rem .8rem;
  border-radius:999px;
  background:rgba(153,205,104,.12);
}

.feedback.muted{
  color:var(--muted);
}

.estado p{
  margin:0;
  text-align:center;
}

/* ======================================================
   Cierre: botones CTA finales
   ====================================================== */
.cta-buttons{
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:.75rem;
  margin-top:1rem;
}
#finalActions .btn.secundario{
  background:var(--btn-sec-bg);
  color:var(--btn-sec-fg);
  min-width:220px;
  padding:1rem 1.4rem;
  font-size:1.05rem;
}

/* ======================================================
   Footer
   ====================================================== */
.mini-credit{
  margin-top:.6rem;
  padding:.4rem 0;
  border-top:1px solid var(--border);
  font-size:.65em;
  line-height:1.35;
  color:var(--muted);
  max-width:980px;
  margin-inline:auto;
  display:flex;
  flex-direction:column;
  align-items:center;
  text-align:center;
}

/* ======================================================
   Accesibilidad
   ====================================================== */
.skip{
  position:absolute;
  left:-9999px;
  top:auto;
  width:1px;
  height:1px;
  overflow:hidden;
}

.skip:focus{
  left:0;
  top:0;
  width:auto;
  height:auto;
  background:#fff;
  padding:.5rem .75rem;
  z-index:999;
}

/* Modal */
.modal-backdrop.hidden{
  display:none;
}
.modal-content{
  max-height:min(640px, 90vh);
  overflow:auto;
}

/* ======================================================
   Responsive
   ====================================================== */
@media (max-width:640px){
  body{
    font-size:clamp(16px, 4vw, 18px);
  }
  .enunciado{
    font-size:1.75rem;
  }
  .opcion-btn{
    font-size:1rem;
    padding:.85rem 1rem;
  }
}

/* Micro-respiro entre select Rondas y botón */
.control--rondas select{
  margin-bottom:2px;
}

/* Foco visible claro en el botón principal */
#btnComenzar:focus-visible{
  outline:3px solid var(--focus);
  outline-offset:3px;
}
